# Brain connectivity prediction with Spatial and temporal graph neural network

This work focus on sensor level brain connectivity prediction using EEG data. It provides the prediction in 2 steps. 1st Spatial and temporal graph neural network (Graph Wavenet) forecasts the 64 EEG channels. In the 2nd step this 64 chennals used to calculate the brain connectivity utilizing the imaginary part of coherence method.  

![alt text](https://github.com/TroyaCh/GWNet/blob/main/image/Architecture.png)

## Requirements
a conda environment.yml file is provided. The environment can be installed with:

```bash
conda env create -f environment.yml
```

## Data preparation
The spatial infornation matrix is need to be generated using  spatial_conn_matrix.ipynb. 

The original data needs to be stored in the directory (./data/) .The training, validation and test samples can be generated by running:

```bash
python data_preprocess.py --input_dir=./data/ --output_dir=./data/training_samples_1024
```

## Training

The model can then be trained by running:
```bash
python gwn_brain_conn_train.py --config ./config/config_256_05.yaml
```

## Acknowledgement
the model architecture was originally proposed by [Wu et al.](https://arxiv.org/abs/1906.00121).The  [pytorch-implementation] (https://github.com/nnzhan/Graph-WaveNet)
